<h1>Projeto 02 - Blog Pessoal - Deploy do Backend no Render</h1>

<br />

<h2>1. O que √© Deploy?</h2>



O verbo **Deploy**, em ingl√™s, significa **implantar**.

Em programa√ß√£o, seu sentido est√° intimamente relacionado √† sua tradu√ß√£o literal: fazer um deploy, em termos pr√°ticos, significa colocar na nuvem, ou seja, publicar na Internet alguma aplica√ß√£o que teve seu desenvolvimento conclu√≠do.
Quando um site √© finalizado por uma pessoa desenvolvedora, ele passa pelos √∫ltimos testes e finalmente ele √© hospedado na nuvem atrav√©s do processo chamado deploy.
Do mesmo modo, quando um sistema sofre alguma melhoria ou altera√ß√£o em seu c√≥digo-fonte, implementar essa altera√ß√£o ao sistema que est√° publicado (em Produ√ß√£o), tamb√©m √© chamado de deploy, s√≥ que incremental.

<br />

<h2>2. O que veremos por aqui?</h2>



Esse documento √© um passo a passo para voc√™ enviar a sua aplica√ß√£o ASP.NET, gratuitamente para a nuvem. Este processo ir√° gerar um link de acesso a sua aplica√ß√£o, que poder√° ser acessado de qualquer lugar, a partir de qualquer dispositivo com acesso a Internet. 
Para efetuar o Deploy vamos precisar fazer algumas modifica√ß√µes em nosso projeto, que ser√£o detalhadas nos pr√≥ximos t√≥picos.

<br />

<h2>üë£ Passo 01 - Personalizar o Swagger</h2>



Caso voc√™ n√£o tenha personalizado o Swagger, volte no t√≥pico <a href="23.md" target="_blank">**Documenta√ß√£o com o Swagger**</a>.

<br />

<h2 id="local">üë£Passo 02 - Testar a API no seu computador</h2>



1. Execute a sua aplica√ß√£o localmente pelo Visual Studio

2. Verifique se o **Swagger** est√° inicializando automaticamente.

3. Caso voc√™ n√£o tenha testado no **Insomnia**, execute todos os testes e verifique se tudo est√° funcionando. 

4. Em especial, verifique se o M√©todo **logar** est√° devolvendo o **Token**.

5. Antes de continuar a configura√ß√£o do projeto para efetuar o Deploy, n√£o esque√ßa de **parar a execu√ß√£o do Projeto no Visual Studio**.


| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:**  *Lembre-se que antes de fazer o Deploy √© fundamental que a API esteja rodando e sem erros*. Preferencialmente utilize o Insomnia para fazer os testes.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 03 - Criar uma conta gr√°tis no Render</h2>

<br />

<h3>3.1 O que √© o Render?</h3>



O Render √© uma plataforma unificada para criar e executar todos os seus aplicativos e sites. O Render permite criar e executar todos os seus aplicativos e sites com SSL gratuito, um CDN global, redes privadas e implanta√ß√µes autom√°ticas do Git. 

> Uma **CDN** (Rede de Entrega de Conte√∫do) √© um grupo de servidores geograficamente distribu√≠dos que aceleram a entrega do conte√∫do da Web, aproximando-o de onde os usu√°rios est√£o. 

O Render √© classificado como um **PaaS** (plataforma como servi√ßo), ou seja, √© um conjunto de servi√ßos para criar e gerenciar  aplicativos na nuvem. PaaS fornece os componentes de infraestrutura, que permitem que as pessoas Desenvolvedoras criem, integrem, migrem,   implementem, protejam e gerenciem aplicativos m√≥veis e da web, de forma  simples e r√°pida.

> **Modelos de Servi√ßos na Nuvem:**
>
> - **Plataforma como um servi√ßo (PaaS):** Um provedor de  servi√ßos oferece acesso a um ambiente baseado em cloud no qual os  usu√°rios podem desenvolver e fornecer aplicativos. Al√©m do **Render**, o **Render** e o **Azure** da Microsoft tamb√©m utilizam este modelo.
> - **Infraestrutura como um servi√ßo (IaaS):**  Um provedor de servi√ßos fornece aos clientes acesso Pay As You Go (Pague pelo que  voc√™ usar), para  armazenamento, rede, servidores e outros recursos de  computa√ß√£o na  cloud. O **AWS da Amazon e a Digital Ocean** seguem este modelo.
> - **Software como um servi√ßo (SaaS):** Um provedor de  servi√ßos oferece softwares e aplicativos por meio da  Internet. Os  usu√°rios subscrevem ao software e o acessam por meio da web ou de API's  do fabricante. o **Google Apps e do Microsoft Office 365** seguem este modelo.

Um grande diferencial do Render √© que ele oferece **contas gratu√≠tas**, com algumas limita√ß√µes, que permitem hospedar aplica√ß√µes desenvolvidas em diversas linguagens e **01 Banco de dados PostgreSQL**.

**Principais Limita√ß√µes do Plano Gratuito:**

- Se a aplica√ß√£o ficar **15 minutos sem receber nenhuma requisi√ß√£o**, o aplicativo √© finalizado e ser√° reiniciado somente quando receber outra requisi√ß√£o, para economizar os recursos da plataforma.
- Os servidores do Render est√£o dispon√≠veis apenas na Europa, √Åsia e nos Estados Unidos.
- Os recursos de Mem√≥ria, Disco e Processamento s√£o  limitados, logo a aplica√ß√£o e principalmente o Banco de dados n√£o podem  ser muito grandes.
- Aceita **apenas um Banco de dados por conta**;
- O **tr√°fego mensal √© limitado a 750 horas somando todas as aplica√ß√µes e o Banco de dados**, ou seja, se ultrapassar este valor antes do m√™s acabar, sua conta ficar√° suspensa at√© o m√™s seguinte;
- Dependendo da linguagem, o Deploy da aplica√ß√£o dever√° ser realizado via Docker.

<br />

<div align="left"><img src="https://i.imgur.com/nnCZtX8.png" title="source: imgur.com" width="25px"/> <a href="https://render.com/docs/free" target="_blank"><b>Documenta√ß√£o: Render - Plano Gratu√≠to</b></a></div>

<br />

Vamos criar a conta no Render para fazermos o Deploy:

1) Acesse o endere√ßo: **https://www.render.com**

<div align="center"><img src="https://i.imgur.com/1VVzxQD.png" title="source: imgur.com" width="90%"/></div>

2. Existem diversas formas de criar uma conta no Render. Neste Guia utilizaremos a conta do Github. Clique no link **GitHub**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/xfjXrJ8.png" title="source: imgur.com" /></div>

3. Na pr√≥xima janela, digite o endere√ßo do e-mail e a senha da sua conta do Github, e em seguida clique no bot√£o **Sign in**

<div align="center"><img src="https://i.imgur.com/gOhiPeU.png" title="source: imgur.com" /></div>

4. Na pr√≥xima janela, autorize o Render a acessar a sua conta do Github, clicando no bot√£o **Authorize Render**.

<div align="center"><img src="https://i.imgur.com/H3q1w18.png" title="source: imgur.com" /></div>

5. Na pr√≥xima janela, confirme se o endere√ßo do e-mail est√° correto e clique no bot√£o **COMPLETE SIGN UP**

<div align="center"><img src="https://i.imgur.com/AA50W1E.png" title="source: imgur.com" /></div>

6. Na pr√≥xima janela, ser√° exibida uma mensagem solicitando que voc√™ verifique se recebeu uma mensagem no seu e-mail para validar a sua conta no Render. Abra a sua conta de e-mail e verifique se o e-mail foi recebido. Caso n√£o tenha recebido, clique no bot√£o **RESEND VERIFICATION EMAIL**.

<div align="center"><img src="https://i.imgur.com/rZGSHqM.png" title="source: imgur.com" /></div>

7. Abra o e-mail enviado pelo Render (semelhante a imagem abaixo) e **clique no link para validar a sua conta**.

<div align="center"><img src="https://i.imgur.com/wlXD6G8.png" title="source: imgur.com" /></div>

8. Depois de clicar no link, sua conta ser√° validada e ser√° redirecionada para a tela do **Dashboard**.

<div align="center"><img src="https://i.imgur.com/AusmZfX.png" title="source: imgur.com" /></div>

<br />


| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:**  *Conclua todas etapas do processo de cria√ß√£o da conta no Render antes de avan√ßar para o pr√≥ximo passo do Deploy*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 04 - Instalar o Pacote do PostgreSQL</h2>



O Render, na sua vers√£o gratuita, utiliza o **PostgreSQL** como **SGBD** (Sistema Gerenciador de Bando de dados). 

No Bloco 02 estamos utilizando o **SQL Server** para desenvolver o Blog Pessoal. Ambos s√£o Banco de dados Relacionais e gra√ßas ao **Entity Framework Core**, n√£o ser√° necess√°rio realizar nenhuma altera√ß√£o no c√≥digo da nossa aplica√ß√£o. A √∫nica mudan√ßa necess√°ria, al√©m de instalar o **Pacote do PostgreSQL**,  ser√° necess√°rio configurar a conex√£o com o Banco de dados PostgreSQL na nuvem. 

<br />

<div align="left"><img src="https://i.imgur.com/b3khcJI.png" title="source: imgur.com" width="25px"/> <a href="https://www.postgresql.org/" target="_blank"><b>Site Oficial: PostgreSQL</b></a></div>

<br />

Para acessar uma Banco de dados **PostgreSQL** precisamos instalar o Pacote **Npgsql.EntityFrameworkCore.PostgreSQL**, atrav√©s do **NUGET**:

1. No **Gerenciador de Solu√ß√µes** vamos selecionar o projeto **blogpessoal**:

<div align="center"><img src="https://i.imgur.com/PFeqaL1.png" title="source: imgur.com" /></div>

2. Para abrir o **Gerenciador de Pacotes do Nuget** no Visual Studio, clique no Menu **Projeto ü°¢ Gerenciador de Pacotes do Nuget**

<div align="center"><img src="https://i.imgur.com/py7lAQ5.gif" title="source: imgur.com" /></div>

3. Ser√° aberta a janela do Nuget.

<div align="center"><img src="https://i.imgur.com/IQMqCPn.png" title="source: imgur.com" /></div>

4. Caso tenha alguma atualiza√ß√£o para ser instalada, observe que na **Guia Atualiza√ß√µes** aparecer√° um n√∫mero indicando o total de atualiza√ß√µes. Clique na **Guia Atualiza√ß√µes** para instalar as atualiza√ß√µes.
5. Na **Guia Atualiza√ß√µes**, marque a caixa **Selecionar todos os pacotes** e clique no bot√£o **Atualizar**.
6. Clique na **Guia Procurar** para localizar os pacotes que ser√£o instalados:

<div align="center"><img src="https://imgur.com/QhxqhPs.png" title="source: imgur.com" /></div>

7. Localize o Pacote **Npgsql.EntityFrameworkCore.PostgreSQL**. Na caixa de texto **Pesquisar** digite o nome do pacote, selecione o pacote como mostra a imagem abaixo e na sequ√™ncia clique no bot√£o **Instalar**, localizado do lado direito da janela do Nuget.

<div align="center"><img src="https://i.imgur.com/OmBw62n.png" title="source: imgur.com" /></div>

8. Ao concluir a Instala√ß√£o do pacote, clique na **Guia Instalado** e verifique se s pacote foi instalado corretamente. 

<br />

<div align="left"><img src="https://i.imgur.com/2czVisH.png" title="source: imgur.com" width="4%"/> <a href="https://www.nuget.org/packages/Npgsql.EntityFrameworkCore.PostgreSQL/7.0.4?_src=template" target="_blank"><b>Documenta√ß√£o: Pacote Npgsql.EntityFrameworkCore.PostgreSQL.</b></a></div>

<br />

<h2>üë£ Passo 05 - Configurar o Banco de Dados na Nuvem</h2>



A Configura√ß√£o do Banco de dados Local √© diferente da configura√ß√£o que ser√° utilizada no Render. 

No passo anterior, adicionamos o Pacote do PostgreSQL no projeto, atrav√©s do **Nuget** e neste passo vamos configurar a aplica√ß√£o para acessar o Banco de dados remoto que ser√° criado no Render.

Para simplificar o processo, vamos utilizar um recurso do ASP.NET chamado **Profiles** (perfis), que nada mais √© do que criar um modelo de configura√ß√£o para cada etapa do desenvolvimento da aplica√ß√£o, ou seja, uma configura√ß√£o para usar localmente e outra configura√ß√£o para usar na nuvem. 

O grande benef√≠cio dos Profiles √© simplificar a troca entre a configura√ß√£o Local (**SQL Server**) e a configura√ß√£o Remota do Render (**PostgreSQL**). 

<br />

<h3>5.1. Atualizar o Arquivo appsettings.json</h3>



No arquivo **appsettings.json** iremos identificar qual perfil utilizaremos para inicializar a nossa aplica√ß√£o:

1. Abra o arquivo **appsettings.json**
2. Adicione o trecho de c√≥digo abaixo no in√≠cio do arquivo:

```json
"Enviroment": {
    "Start": "PROD"
  },
```

3. Veja abaixo o arquivo completo com a altera√ß√£o:

```json
{
  "Enviroment": {
    "Start": "PROD"
  },
  "ConnectionStrings": {
    "DefaultConnection": "Server=LOCALSERVER;Initial Catalog=db_blogpessoal;Trusted_Connection=True;TrustServerCertificate=true;MultipleActiveResultSets=True;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}
```

A propriedade **"Start"** ser√° utilizada para identificar qual Perfil de inicializa√ß√£o da aplica√ß√£o ser√° utilizado:

<b><code>"Start": DEV</code> </b> ü°¢ O ASP.NET executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados local (SQL Server), ou seja, para executar a sua aplica√ß√£o no computador, voc√™ manter√° esta linha com o valor **DEV**.

<b><code>"Start": PROD</code> </b> ü°¢ O ASP.NET executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados remoto (Nuvem do Render - PostgreSQL), ou seja, para executar a sua aplica√ß√£o no Render, voc√™ manter√° esta linha com o valor **PROD**.

Como estamos configurando o projeto para o Deploy, devemos deixar a propriedade **"Start"** configurada com a op√ß√£o **PROD**.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar os perfis do Banco de Dados. Um erro muito comum √© tentar executar o seu projeto no Visual Studio com o Perfil PROD habilitado. Com o perfil PROD habilitado, o projeto N√ÉO ser√° inicializado localmente.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>5.2. Atualizar a Classe Program</h3>



1. Abra a Classe **Program**
2. Localize o trecho de c√≥digo abaixo:

<div align="center"><img src="https://i.imgur.com/f3ZRukI.png" title="source: imgur.com" /></div>

3. Substitua o trecho de c√≥digo acima, pelo trecho abaixo:

```c#
// Conex√£o com o Banco de dados

if (builder.Configuration["Enviroment:Start"] == "PROD")
            {
                /* Conex√£o Remota (Nuvem) - PostgreSQL */
                
                builder.Configuration
                .SetBasePath(Directory.GetCurrentDirectory()).AddJsonFile("secrets.json");

                var connectionString = builder.Configuration
                    .GetConnectionString("ProdConnection");

                builder.Services.AddDbContext<AppDbContext>(options =>
                    options.UseNpgsql(connectionString)
                );

            }
            else
            {
                /* Conex√£o Local - SQL Server */
                
                var connectionString = builder.Configuration.
                    GetConnectionString("DefaultConnection");

                builder.Services.AddDbContext<AppDbContext>(options =>
                    options.UseSqlServer(connectionString)
                );
            }
```

Esta altera√ß√£o cria um La√ßo Condicional que verifica qual Perfil foi selecionado no arquivo **appsettings.json**. Se o Perfil habilitado for **PROD**, a aplica√ß√£o vai procurar um arquivo chamado **secrets.json**, que iremos criar na Nuvem e utilizar√° a String de conex√£o chamada **ProdConnection**. Caso contr√°rio (**Perfil DEV**), utilizar√° a conex√£o local (SQL Server).

Caso voc√™ tente executar a aplica√ß√£o localmente com o Perfil **PROD**, voc√™ receber√° a Mensagem de erro abaixo, indicando que n√£o foi poss√≠vel encontrar o arquivo **secrets.json**:

<div align="center"><img src="https://i.imgur.com/MOXFcK6.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/b3khcJI.png" title="source: imgur.com" width="4%"/> <a href="https://www.postgresql.org/" target="_blank"><b>Site Oficial: PostgreSQL</b></a></div>

<br />

<h2>üë£ Passo 06 - Configurar o Swagger como P√°gina inicial na Nuvem</h2>



Aproveitando que j√° estamos atualizando a Classe **Program**, vamos configurar o Swagger como a P√°gina Inicial (Home), da nossa aplica√ß√£o, ao ser execuatada na nuvem:

1. Na Classe **Program**, localize o trecho de c√≥digo abaixo:

<div align="center"><img src="https://i.imgur.com/8ytQLuX.png" title="source: imgur.com" /></div>

2. Logo abaixo deste trecho (depois da linha 173 no exemplo acima), insira o trecho de c√≥digo abaixo:

```c#
		// Swagger como P√°gina Inicial (Home) na Nuvem
            if (app.Environment.IsProduction())
            {
                app.UseSwaggerUI(c =>
                {
                    c.SwaggerEndpoint("/swagger/v1/swagger.json", "Blog Pessoal - V1");
                    c.RoutePrefix = string.Empty;
                });
            }
```

Esta altera√ß√£o cria um La√ßo Condicional que verifica se a plica√ß√£o est√° sendo executada na Nuvem (Produ√ß√£o), caso esteja, ela define o endpoint do Swagger e a Rota (vazio indica endere√ßo ra√≠z "/", ou seja home). Logo toda vez que abrirmos a aplica√ß√£o na nuvem, como o endere√ßo criado no Render, a primeira p√°gina que ser√° aberta, ser√° o Swagger.

Abaixo, voc√™ confere como ficou a Classe **Program**, com todas as altera√ß√µes:

```c#
using blogpessoal.Data;
using blogpessoal.Model;
using blogpessoal.Service.Implements;
using blogpessoal.Service;
using blogpessoal.Validator;
using FluentValidation;
using Microsoft.EntityFrameworkCore;
using blogpessoal.Security;
using Microsoft.AspNetCore.Authentication.JwtBearer;
using Microsoft.IdentityModel.Tokens;
using System.Text;
using blogpessoal.Security.Implements;
using Microsoft.OpenApi.Models;
using MicroElements.Swashbuckle.FluentValidation.AspNetCore;
using blogpessoal.Configuration;

namespace blogpessoal
{
    public class Program
    {
        public static void Main(string[] args)
        {
            var builder = WebApplication.CreateBuilder(args);

            // Add services to the container.

            // Add Controller Class
            builder.Services.AddControllers()
                .AddNewtonsoftJson(options =>
                {
                    options.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
                }
            );

            // Conex√£o com o Banco de dados

            if (builder.Configuration["Enviroment:Start"] == "PROD")
            {
                /* Conex√£o Remota (Nuvem) - PostgreSQL */

                builder.Configuration
                .SetBasePath(Directory.GetCurrentDirectory()).AddJsonFile("secrets.json");

                var connectionString = builder.Configuration
                    .GetConnectionString("ProdConnection");

                builder.Services.AddDbContext<AppDbContext>(options =>
                    options.UseNpgsql(connectionString)
                );

            }
            else
            {
                /* Conex√£o Local - SQL Server */

                var connectionString = builder.Configuration.
                    GetConnectionString("DefaultConnection");

                builder.Services.AddDbContext<AppDbContext>(options =>
                    options.UseSqlServer(connectionString)
                );
            }

            // Valida√ß√£o das Entidades
            builder.Services.AddTransient<IValidator<Postagem>, PostagemValidator>();
            builder.Services.AddTransient<IValidator<Tema>, TemaValidator>();
            builder.Services.AddTransient<IValidator<User>, UserValidator>();

            // Registrar as Classes e Interfaces Service
            builder.Services.AddScoped<IPostagemService, PostagemService>();
            builder.Services.AddScoped<ITemaService, TemaService>();
            builder.Services.AddScoped<IUserService, UserService>();
            builder.Services.AddTransient<IAuthService, AuthService>();

            // Adicionar a Valida√ß√£o do Token JWT

            builder.Services.AddAuthentication(x =>
            {
                x.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;
                x.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;
            }).AddJwtBearer(o =>
            {
                var Key = Encoding.UTF8.GetBytes(Settings.Secret);
                o.SaveToken = true;
                o.TokenValidationParameters = new TokenValidationParameters
                {
                    ValidateIssuer = false,
                    ValidateAudience = false,
                    ValidateLifetime = true,
                    ValidateIssuerSigningKey = true,
                    IssuerSigningKey = new SymmetricSecurityKey(Key),
                };
            });

            // Learn more about configuring Swagger/OpenAPI
            // at https://aka.ms/aspnetcore/swashbuckle

            builder.Services.AddEndpointsApiExplorer();

            //Registrar o Swagger
            builder.Services.AddSwaggerGen(options =>
            {

                //Personalizar a P√°gna inicial do Swagger
                options.SwaggerDoc("v1", new OpenApiInfo
                {
                    Version = "v1",
                    Title = "Projeto Blog Pessoal",
                    Description = "Projeto Blog Pessoal - ASP.NET Core 7 - Entity Framework",
                    Contact = new OpenApiContact
                    {
                        Name = "Generation Brasil",
                        Email = "conteudogeneration@generation.org",
                        Url = new Uri("https://github.com/conteudoGeneration")
                    },
                    License = new OpenApiLicense
                    {
                        Name = "Github",
                        Url = new Uri("https://github.com/conteudoGeneration")
                    }
                });

                //Adicionar a Seguran√ßa no Swagger
                options.AddSecurityDefinition("JWT", new OpenApiSecurityScheme
                {
                    In = ParameterLocation.Header,
                    Description = "Digite um Token JWT v√°lido!",
                    Name = "Authorization",
                    Type = SecuritySchemeType.Http,
                    BearerFormat = "JWT",
                    Scheme = "Bearer"
                });

                //Adicionar a configura√ß√£o visual da Seguran√ßa no Swagger
                options.OperationFilter<AuthResponsesOperationFilter>();

            });

            // Adicionar o Fluent Validation no Swagger
            builder.Services.AddFluentValidationRulesToSwagger();


            // Configura√ß√£o do CORS
            builder.Services.AddCors(options => {
                options.AddPolicy(name: "MyPolicy",
                    policy =>
                    {
                        policy.AllowAnyOrigin()
                        .AllowAnyHeader()
                        .AllowAnyMethod();
                    });
            });

            var app = builder.Build();

            // Criar o Banco de dados e as tabelas Automaticamente
            using (var scope = app.Services.CreateAsyncScope())
            {
                var dbContext = scope.ServiceProvider.GetRequiredService<AppDbContext>();
                dbContext.Database.EnsureCreated();

            }

            app.UseDeveloperExceptionPage();

            // Habilitar o Swagger
            app.UseSwagger();

            app.UseSwaggerUI();

            // Swagger como P√°gina Inicial (Home) na Nuvem
            if (app.Environment.IsProduction())
            {
                app.UseSwaggerUI(c =>
                {
                    c.SwaggerEndpoint("/swagger/v1/swagger.json", "Blog Pessoal - V1");
                    c.RoutePrefix = string.Empty;
                });
            }

            //Habilitar CORS

            app.UseCors("MyPolicy");

            // Habilitar a Autentica√ß√£o e a Autoriza√ß√£o

            app.UseAuthentication();

            app.UseAuthorization();

            // Habilitar Controller
            app.MapControllers();

            app.Run();
        }
    }
}

// Cria uma Classe Parcial para executar os Testes no xUnit
public partial class Program { }

```

<br />    

<h2>üë£ Passo 07 - Criar o arquivo Dockerfile</h2>



O Render n√£o possui nativamente o suporte ao Java. Como op√ß√£o para fazer o Deploy de aplica√ß√µes Java, o Render oferece a possibilidade de utilizar o **Docker**, sem a necessidade de instalar o Docker Desktop no computador.

O **Docker** √© um projeto para automatizar a implanta√ß√£o de aplicativos como **Containers** autossuficientes e port√°teis, que podem ser executados na nuvem ou localmente, a partir de **imagens** contendo o ambiente m√≠nimo para executar uma aplica√ß√£o. 

Uma **Imagem** nada mais √© do que uma **representa√ß√£o imut√°vel** de como ser√° efetivamente constru√≠do um container. **Exemplo:** uma imagem contendo o Ubuntu Linux, uma imagem contendo o Java 17, entre outros. 

Como uma imagem √© imut√°vel, n√≥s n√£o podemos executar a imagem de forma direta, n√≥s fazemos isso atrav√©s de um **Container**, que √© uma tecnologia que permite empacotar e isolar aplica√ß√µes com  o seu  ambiente de tempo de execu√ß√£o, ou seja, com todos os arquivos  necess√°rios para executar.

<div align="center"><img width="65%" src="https://i.imgur.com/ZnwbDac.png" title="source: imgur.com" /></div>

O ponto principal que precisamos compreender para efetuarmos o Deploy da nossa aplica√ß√£o no Render √© que escrevemos um **Dockerfile**, constru√≠mos uma imagem a partir do Dockerfile, e por fim, criamos e executamos o container. **O container √© o fim enquanto a imagem √© o meio**.

<div align="center"><img width="65%" src="https://i.imgur.com/7jQda72.png" title="source: imgur.com" /></div>

O **Dockerfile** nada mais √© do que **um meio que utilizamos para criar nossas pr√≥prias imagens**. Em outras palavras, ele serve como uma **receita para construir um container**, permitindo definir um ambiente personalizado e pr√≥prio para meu projeto pessoal ou empresarial. 

No Projeto Blog Pessoal n√≥s iremos **construir o Dockerfile e o Render se encarregar√° de construir a Imagem e o Container com o ambiente necess√°rio para executar o projeto Blog Pessoal**.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** *O nosso foco n√£o √© estudar o Docker. O foco neste momento √© compreender como criaremos o Dockerfile necess√°rio para efetuarmos o Deploy da nossa aplica√ß√£o no Render*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Veja na tabela abaixo os comandos do **Dockerfile** que vamos utilizar:

| Comandos       | Descri√ß√£o                                                    |
| -------------- | ------------------------------------------------------------ |
| **FROM**       | Deve ser o primeiro comando de um Dockerfile, com ele configuramos qual a imagem que queremos utilizar como base na nossa imagem. Podemos criar uma imagem a partir de uma imagem do Java ou de um sistema Linux e assim por diante. |
| **RUN**        | Serve para executar comandos no processo de montagem da imagem que estamos construindo no Dockerfile, ele √© executado durante o *build* (constru√ß√£o da imagem) e n√£o durante a constru√ß√£o do container. Em um Dockerfile √© poss√≠vel ter mais de um comando **RUN**. |
| **COPY**       | Comando para copiar arquivos e pastas de um lugar espec√≠fico na m√°quina local para uma pasta no container. O COPY √© utilizado para copiar arquivos e pastas locais. |
| **EXPOSE**     | Configura as portas que o container ir√° expor, ou seja, torna o container acess√≠vel atrav√©s das portas configuradas. |
| **WORKDIR**    | Define a pasta dentro do container onde os comandos ser√£o executados. |
| **ENTRYPOINT** | √â um comando que n√£o pode ser sobrescrito, ele sempre ser√° executado e o container ir√° rodar como um execut√°vel. Quando este comando "morrer" (finalizar), o container morrer√° tamb√©m. |
| **ENV**        | Comando utilizado para configurar vari√°veis de ambiente para o container. |

O Render ao receber o Dockerfile atrav√©s do reposit√≥rio do Github, vai gerar a Imagem e o Container automaticamente, e caso n√£o aconte√ßa nenhum erro, a sua aplica√ß√£o ser√° implantada na nuvem e o Render lhe oferecer√° um endere√ßo (https://meuprojeto.onrender.com) para acessar externamente. Veja umresumo do processo na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/dCYumMm.png" title="source: imgur.com" /></div>

Vamos criar o arquivo **Dockerfile** no projeto Blog Pessoal:

1. Clique com o bot√£o direito do mouse sobre o porjeto **blogpessoal** e clique na op√ß√£o **Adicionar ü°¢ Suporte do Docker**, como mostra a anima√ß√£o abaixo:

<div align="center"><img src="https://i.imgur.com/TBuug3D.gif" title="source: imgur.com" /></div>

2. Ser√° aberta a janela abaixo, perguntando em **Qual Sistema Operacional o container ser√° executado?**. Selecione a op√ß√£o **Linux** e clique em **OK**.

<div align="center"><img src="https://i.imgur.com/fTbQXs6.png" title="source: imgur.com" /></div>

3. Caso seja perguntado se voc√™ **Deseja instalar o Docker?**, responda que N√£o.
4. Caso voc√™ tenha o Docker instalado na sua m√°quina, ser√° exibida a mensagem abaixo, perguntando se voc√™ **Deseja iniciar o Docker Desktop?**, responda **N√£o**.

<div align="center"><img src="https://i.imgur.com/0kyefbX.png" title="source: imgur.com" /></div>

5. O **Visual Studio** ir√° gerar o arquivo **Dockerfile** com o conte√∫do abaixo:

<div align="center"><img src="https://i.imgur.com/GWwp0VX.png" title="source: imgur.com" /></div>

6. Adicione a linha abaixo depois da linha **FROM mcr.microsoft.com/dotnet/aspnet:7.0 AS base**:

```dockerfile
ENV ASPNETCORE_URLS http://*:80
```

Na imagem abaixo, voc√™ confere a vers√£o final do c√≥digo:

<div align="center"><img src="https://i.imgur.com/TzuqPHd.png" title="source: imgur.com" /></div>

O Dockerfile gerado pelo Visual Studio utiliza as Boas Pr√°ticas recomendadas de compila√ß√µes em v√°rios est√°gios (Multi-Staged) para garantir que as suas imagens Docker sejam as menores e mais r√°pidas poss√≠veis ao serem executadas. A Constru√ß√£o da imagem √© dividida em 4 fases distintas

**Linhas 01 a 04:** Esta etapa define a imagem base (SDK do .NET), que ser√° usada para executar seu aplicativo. Ele cont√©m as depend√™ncias m√≠nimas para executar seu aplicativo. A Vari√°vel que foi criada na linha 02 inidica a porta que o Render utilizar√°.

**Linhas 06 a 12:** Esta etapa define a imagem do Docker que ser√° usada para criar seu aplicativo. Inclui o .NET SDK completo, bem como v√°rias outras depend√™ncias. Este est√°gio realmente constr√≥i seu aplicativo. Toda a imagem Docker, sempre parte de uma imagem Base, como uma vers√£o de Linux ou SDK de uma Linguagem ou Framework.

**Linhas 14 e 15:**  Este est√°gio √© usado para publicar seu aplicativo em um container Docker.

**Linhas 17 e 20:**  O est√°gio final √© o que voc√™ realmente implantaria na produ√ß√£o. √â baseado na imagem base, mas com os recursos de publica√ß√£o copiados. A Linha 20 √© grande respons√°vel por inicializar a aplica√ß√£o ASP.NET.

<br />

<div align="left"><img src="https://i.imgur.com/1fDswF4.png" title="source: imgur.com" width="4%"/> <a href="https://docs.docker.com/engine/reference/builder/" target="_blank"><b>Documenta√ß√£o: Dockerfile</b></a></div>

<div align="left"><img src="https://i.imgur.com/wHTDfQ2.png" title="source: imgur.com" width="4%"/> <a href="https://learn.microsoft.com/pt-br/visualstudio/containers/overview?view=vs-2022&toc=%2Fdotnet%2Fnavigate%2Fdevops-testing%2Ftoc.json&bc=%2Fdotnet%2Fbreadcrumb%2Ftoc.json" target="_blank"><b>Documenta√ß√£o: Docker no Visual Studio</b></a></div>

<br />

<h2>üë£ Passo 08 - Atualizar o reposit√≥rio do projeto no Github</h2>



1. Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo:

   ```bash
    git add .
    
    git commit -m ‚ÄúDeploy do Projeto Blog Pessoal‚Äù
    
    git push origin main
   ```
   

O Reposit√≥rio do seu projeto deve estar semelhante a imagem abaixo

<div align="center"><img src="https://i.imgur.com/aRo1dLx.png" title="source: imgur.com" /></div>

Clique na pasta **blogpessoal**. O seu projeto estar√° semelhante a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/ssrDrex.png" title="source: imgur.com" /></div>

Observe que o **Dockerfile** est√° na ra√≠z do projeto.

<br />

<h2>üë£ Passo 09 - Criar o Banco de dados no Render</h2>



1. Para adicionar um novo Banco de dados, no Dashboard do Render, clique no bot√£o **New +** e em seguida clique na op√ß√£o **PostgreSQL**.

<div align="center"><img src="https://i.imgur.com/MbMjaSK.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ATEN√á√ÉO:** O Plano Gratuito do Render autoriza a cria√ß√£o de apenas 1 Banco de dados PostgreSQL por conta. Outro ponto importante √© que me 90 dias o Banco ser√° apagado (Drop Database). </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

2. Na pr√≥xima tela, informe o nome do Banco de dados (**db_blogpesoal**), na propriedade **Name**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/MAYxruf.png" title="source: imgur.com" /></div>

3. Role a tela para baixo e verifique se o Plano Gratuito (**Free**) est√° selecionado e na sequ√™ncia, clique no bot√£o **Create Database**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/xbzgv0j.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ATEN√á√ÉO:** *Caso seja selecionado um plano diferente, o Render exigir√° o Cart√£o de Cr√©dito para emitir a fatura do servi√ßo. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

4. Na pr√≥xima tela, aguarde at√© que o **Status** esteja **Available**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/D8oO8Pe.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** O processo do Deploy enviar√° apenas a sua aplica√ß√£o para a nuvem, logo o Banco de dados que ser√° criado nesta etapa estar√° vazio. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 10 - Criar o Web Service no Render</h2>



1. Na barra de menus principal do Render, clique no item Dashboard, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/AYQts2Z.png" title="source: imgur.com" /></div>

2. Para adicionar um novo Web Service, no Dashboard do Render, clique no bot√£o **New +** e em seguida clique na op√ß√£o **Web Service**.

<div align="center"><img src="https://i.imgur.com/FVGlwLN.png" title="source: imgur.com" /></div>

3. No item **GitHub**, clique no link **+ Connect account**, para conectar a sua conta do Render com a sua Conta do Github.

<div align="center"><img src="https://i.imgur.com/xaffIQz.png" title="source: imgur.com" /></div>

4. Na tela, **Install Render**, clique no seu usu√°rio do Github (no exemplo, rafaelproinfo), como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/hfSfPEx.png" title="source: imgur.com" /></div>

5. Na pr√≥xima tela, clique no bot√£o **Install**, para concordar que o Render acesse a sua Conta do Github.

<div align="center"><img src="https://i.imgur.com/Mvp1eX5.png" title="source: imgur.com" /></div>

6. Conecte o Render com o Reposit√≥rio onde voc√™ enviou o Blog Pessoal, clicando no bot√£o **Connect**, localizado ao lado do Reposit√≥rio.

<div align="center"><img src="https://i.imgur.com/E2JyydO.png" title="source: imgur.com" /></div>

7. Na pr√≥xima tela, informe o nome da sua aplica√ß√£o na propriedade **Name** (blogpessoal), na propriedade **Root Directory** (blogpessoal) informe o nome da pasta e verifique se a propriedade **Environment** est√° com a op√ß√£o **Docker** selecionada.

<div align="center"><img src="https://i.imgur.com/ix0azka.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="120px"/> | <p align="justify"> **ATEN√á√ÉO:** O NOME DO PROJETO N√ÉO PODE CONTER LETRAS MAIUSCULAS, NUMEROS OU CARACTERES ESPECIAIS. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

8. Role a tela para baixo e verifique se o Plano Gratuito (**Free**) est√° selecionado.

<div align="center"><img src="https://i.imgur.com/7TZeGuY.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ATEN√á√ÉO:** Caso seja selecionado um plano diferente, o Render exigir√° o Cart√£o de Cr√©dito para emitir a fatura do servi√ßo. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£Passo 11 - Criar o arquivo secrets.json</h2>



Nesta etapa vamos criar o arquivo **secrets.json**, onde vamos configurar a conex√£o com o Banco de dados na nuvem, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/guBxhed.png" title="source: imgur.com" /></div>

Antes de criarmos o arquivo, precisamos identificar os dados que ser√£o inseridos dentro do JSON, que est√£o dispon√≠veis no **Banco de dados** criado no passo anterior. 

1. Na **Barra Principal** do Render, clique com o bot√£o direito mouse no item **Dashboard** e clique na op√ß√£o **Abrir link em uma Nova Guia**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/EKMMRG5.png" title="source: imgur.com" /></div>

2. Na nova guia que foi aberta, clique no Banco de dados **db_blogpessoal**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/tJzANXP.png" title="source: imgur.com" /></div>

3. Role a tela para baixo e localize o item: **Connections**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/1FVgPZ7.png" title="source: imgur.com" /></div>

4. Na imagem abaixo, est√° indicada qual propriedade do JSON receber√° cada item da configura√ß√£o do Banco de dados na nuvem:

<div align="center"><img src="https://i.imgur.com/DqEZCH2.png" title="source: imgur.com" /></div>

5. Na propriedade **Host**, acrescente no final do **Hostname**: ***.oregon-postgres.render.com***. Caso contr√°rio o ASP.NET n√£o conectar√° com o banco de dados.
6. Nas demais propriedades, utilize os mesmos dados que est√£o na tela do Banco de dados.
7. No exemplo acima, a configura√ß√£o ficou da seguinte forma:

| Vari√°vel             | Conte√∫do                                                |
| -------------------- | ------------------------------------------------------- |
| **POSTGRESHOST**     | *dpg-cj875tk5kgrc73e1s1pg-a.oregon-postgres.render.com* |
| **POSTGRESPORT**     | *5432*                                                  |
| **POSTGRESDATABASE** | *db_blogpessoal_p9hv*                                   |
| **POSTGRESUSER**     | *db_blogpessoal_p9hv_user*                              |
| **POSTGRESPASSWORD** | *senha do banco de dados*                               |

Na imagem abaixo, vemos como fica a string de conex√£o do Banco de dados na Nuvem:

<div align="center"><img src="https://i.imgur.com/afqK2eg.png" title="source: imgur.com" /></div>

Na cor preta vemos a propriedade e em vermelho o valor.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o arquivo secrets.json. Lembre-se que os dados em vermelho devem ser substitu√≠dos pelos dados do Banco de dados do seu projeto Render. N√£o se esque√ßa tamb√©m de fazer o ajuste do endere√ßo do Hostname do Banco de dados.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Agora vamos criar o arquivo **secrets.json**:

1. Volte para a Guia onde o **Web Service** est√° sendo criado e role a tela para baixo e clique no bot√£o **Advanced**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/xBSB5q0.png" title="source: imgur.com" /></div>

2. Na sequ√™ncia, clique no bot√£o **Add Secret File**

<div align="center"><img src="https://i.imgur.com/6iO9Eyd.png" title="source: imgur.com" /></div>

3. No item **Filename**, informe o nome do arquivo: **secrets.json**

<div align="center"><img src="https://i.imgur.com/Cp1EbU0.png" title="source: imgur.com" /></div>

4. No item **File Content** insira o conte√∫do abaixo, com as **configura√ß√µes do Banco de dados do seu Deploy no Render**:

```json
{
  "Enviroment": {
    "Start": "PROD"
  },
  "ConnectionStrings": {
    "ProdConnection": "User ID=db_blogpessoal_p9hv_user;Password=xxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxx;Host=dpg-cj875tk5kgrc73e1s1pg-a.oregon-postgres.render.com;Port=5432;Database=db_blogpessoal_p9hv;Pooling=true;SSL Mode=Require;TrustServerCertificate=True;"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}
```

5. Clique no bot√£o **Save**.

5. O Deploy ser√° iniciado automaticamente.

5. Acompanhe o processo do Deploy no **Log do Web Service**, como mostra a imagem abaixo:


<div align="center"><img src="https://i.imgur.com/8nGRjnM.png" title="source: imgur.com" /></div>

8. Ao **finalizar a cria√ß√£o da imagem e do Container Docker**, ser√° exibida a mensagem: **DONE**, como mostra a imagem abaixo e na sequ√™ncia a aplica√ß√£o ser√° iniciada.

<div align="center"><img src="https://i.imgur.com/9dmvu47.png" title="source: imgur.com" /></div>

9. Observe na imagem abaixo, que caso a aplica√ß√£o inicialize sem erros, ser√° exibida a mensagem informando que a aplica√ß√£o est√° em execu√ß√£o. A mensagem √© a mesma que √© exibida no **Console do Visual Studio**.

<div align="center"><img src="https://i.imgur.com/nwtCDtR.png" title="source: imgur.com" /></div>

10. Para **confirmar que o Deploy foi conclu√≠do com √™xito**, verifique na parte superior da tela de **Log do Webservice**, se apareceu a mensagem **Live**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/JSpmdr5.png" title="source: imgur.com" /></div>

11. Se apareceu esta mensagem, o Deploy foi finalizado com sucesso!

12. Para abrir a aplica√ß√£o no Navegador da Internet, clique no link da aplica√ß√£o, indicado na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/tgEfV7G.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** Ao clicar no link da aplica√ß√£o, o projeto pode n√£o abrir automaticamente no navegador. Como o Docker precisa finalizar alguns processos, ele pode demorar alguns minutos para abrir. O tempo m√©dio do processo de deploy completo do Blog Pessoal pode demorar um pouco.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Caso o nome do projeto j√° seja um endere√ßo em uso no Render, ele acrescentar√° caracteres aleat√≥rios depois do nome do projeto ao criar o endere√ßo da aplica√ß√£o. Exemplo: blogpessoal-wrtc.onrender.com*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>‚ùå O Deploy n√£o Abriu!</h2>



‚ùå**O Deploy n√£o abre no Navegador**

-  Se o **Console** indica que a aplica√ß√£o subiu, mas ao abrir a aplica√ß√£o no Navegador aparece a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/AlKoYkc.png" title="source: imgur.com" /></div>

- Clique no bot√£o **Manual Deploy** e em seguida, clique na op√ß√£o **Clear build cache & deploy** para refazer o deploy, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/3zTUQrU.png" title="source: imgur.com" /></div>

- Aguarde a conclus√£o e tente abrir novamente

‚ùå**O Deploy Falhou**

- Se aparecer a mensagem **Failed**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/7SaAc4l.png" title="source: imgur.com" /></div>

- Caso n√£o tenha aparecido mensagens de erro no **Console, na tela Log do Webservice** (O projeto ASP.NET inicializou, mas o deploy falhou), clique no bot√£o **Manual Deploy** e em seguida, clique na op√ß√£o **Clear build cache & deploy** para refazer o deploy, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/3zTUQrU.png" title="source: imgur.com" /></div>

- Se o erro persistir, verifique se as **propriedades da conex√£o, inseridas no arquivo secrets.json, est√£o configuradas corretamente**. Caso seja necess√°rio atualizar o valor de qualquer propriedade, o Render iniciar√° um novo Deploy automaticamente ap√≥s a atualiza√ß√£o;
- Caso tenha aparecido algum erro no **Log do Web Service**, identifique o tipo do erro:
  - Se for erro no **Dockerfile**, corrija o erro e atualize o seu reposit√≥rio no Github;
  - Se for erro de c√≥digo (erro do ASP.NET), siga as instru√ß√µes do t√≥pico: <a href="#update">**3. Como atualizar o Deploy no Render?**</a> e corrija o erro.


<br />

<h2>üë£ Passo 11 - Abrir o Deploy no Navegador</h2>



1. Ao abrir a sua aplica√ß√£o no Navegador, ser√° exibida a tela de login abaixo. Como o Banco de dados criado no Render est√° vazio, precisamos criar uma conta de usu√°rio e efetuar o login com esta conta antes de exibir a sua documenta√ß√£o no Swagger. 

<div align="center"><img src="https://i.imgur.com/MTFkYZb.png" title="source: imgur.com" /></div>

2. Abra o **Insomnia** e acesse a Workspace **Blog Pessoal**.

3. Crie uma pasta chamada **Blog Pessoal** e arraste as 3 pastas (Postagem, Tema e Usuario) para dentro dela.

4. Duplique a pasta **Blog Pessoal**.

5. Na pr√≥xima janela, defina o nome da nova pasta como **Blog Pessoal - Render**.

<div align="center"><img src="https://i.imgur.com/hE8xkGA.png" title="source: imgur.com" /></div>

6. Abra a requisi√ß√£o **Cadastrar Usu√°rio** na pasta **Blog Pessoal - Render**.

7. Altere o caminho atual: **http://localhost:8080/usuarios/cadastrar** 

<div align="center"><img src="https://i.imgur.com/0zGznXO.png" title="source: imgur.com" /></div>

8. Para o endere√ßo do Render: https://meuprojeto.render.com/usuarios/cadastrar (No exemplo acima: https://blogpessoal.onrender.com/usuarios/cadastrar)

<div align="center"><img src="https://i.imgur.com/HmopPqF.png" title="source: imgur.com" /></div>

9. Ap√≥s efetuar as altera√ß√µes, crie o usu√°rio **root@root.com** com os dados da imagem abaixo:

<div align="center"><img src="https://i.imgur.com/3GD5gh1.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Crie o usu√°rio root exatamente como mostra a figura acima. Ser√° atrav√©s deste usu√°rio que os Instrutores da sua turma ir√£o corrigir o seu projeto*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

10. Volte para o Navegador da Internet e efetue o login com o usu√°rio **root@root.com**.

<div align="center"><img src="https://i.imgur.com/A3NXaGE.png" title="source: imgur.com" /></div>

11. A Documenta√ß√£o no Swagger ser√° exibida como a p√°gina inicial.

<div align="center"><img src="https://i.imgur.com/SJHPYNu.png" title="source: imgur.com" width="90%"/></div>

12. Outra forma de abrir a aplica√ß√£o √© digitando o endere√ßo: **https://nomedoprojeto.onrender.com** no navegador. (No exemplo acima: https://blogpessoal.onrender.com)

<br />

<h2>üë£ Passo 12 - Testar o Deploy no Insomnia</h2>

1. Volte para o **Insomnia** 

2. Atualize o endere√ßo de todas requisi√ß√µes da pasta **Blog Pessoal - Render**, assim como foi feito na requisi√ß√£o **Cadastrar Usu√°rio**

3. Execute a requisi√ß√£o **Login** para acessar a API

4. Teste todas requisi√ß√µes seguindo as orienta√ß√µes do **Checklist do Projeto Blog Pessoal**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes e a persist√™ncia. Insira dados na API atrav√©s do Insomnia em todos os recursos (Postagem, Tema e Usuario). No recurso Postagem, n√£o esque√ßa de testar o Relacionamento entre as Classes*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2 id="update">3. Como atualizar o Deploy no Render? </h2>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Este item voc√™ utilizar√° apenas se voc√™ precisar alterar alguma coisa no seu projeto ASP.NET e atualizar  a aplica√ß√£o na nuvem*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Para fazer altera√ß√µes no c√≥digo do projeto e executar localmente, volte para o **STS** e altere a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=dev
```

2. Fa√ßa as altera√ß√µes necess√°rias no c√≥digo do seu projeto, execute localmente e verifique se est√° tudo funcionando **sem erros**.

3. Antes de refazer o Deploy, altere novamente a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=prod
```

4.  Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo: 

```bash
git add .
git commit -m ‚ÄúAtualiza√ß√£o do Deploy - Blog Pessoal‚Äù
git push origin main
```

5. Ao finalizar o **git push**, o Render come√ßar√° a refazer o Deploy. Acompanhe o processo pelo **Dashboard do Render**. 

<div align="center"><img src="https://i.imgur.com/Fj5OmPo.png" title="source: imgur.com" /></div>

6. Verifique se a Aplica√ß√£o abre no Navegador e fa√ßa os testes no Insomnia.

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>