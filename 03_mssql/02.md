<h1>Banco de Dados Relacional com SQL Server - parte 01</h1>




O que veremos por aqui:

1. Introdução ao SQL Server
2. Entendendo: Comandos e Conceitos Básicos da Linguagem SQL

<br />

<h2>1. SQL Server</h2>

O SQL Server é um sistema de gerenciamento de banco de dados (SGBD), que utiliza a linguagem SQL (Linguagem de Consulta Estruturada - Structured Query Language) como interface. É atualmente um dos Sistemas de Gerenciamento de Banco de dados mais populares, desenvolvido pela Microsoft. Possui versões pagas e a versão Community (gratuita), que utilizaremos em nossas Sessões.

<br />

<div align="left"><img src="https://i.imgur.com/S5RvRIb.png" title="source: imgur.com" width="4%"/> <a href="https://www.microsoft.com/pt-br/sql-server/sql-server-2022" target="_blank"><b>Site Oficial: <i>SQL Server</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/S5RvRIb.png" title="source: imgur.com" width="4%"/> <a href="https://learn.microsoft.com/pt-br/sql/sql-server/what-s-new-in-sql-server-2022?view=sql-server-ver16" target="_blank"><b>Documentação Oficial: <i>SQL Server</i></b></a></div>

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **DICA:** *Caso você tenha alguma dúvida quanto a instalação do SQL Server, consulte o <a href="../00_ambiente/03_install_sql_server.md" target="_blank" />Guia de Instalação do SQL Server</a>. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>1.1. IDE</h3>

A IDE que utilizaremos para criar e manipular o nosso banco de dados será o SQL Server Management Studio.

<div align="center"><img src="https://i.imgur.com/YdkmoPv.png" title="source: imgur.com" width="75%"/>
</div>

<br />

<div align="left"><img src="https://i.imgur.com/c3kUUoe.png" title="source: imgur.com" width="4%"/> <a href="https://learn.microsoft.com/en-us/sql/ssms/sql-server-management-studio-ssms?view=sql-server-ver16" target="_blank"><b>Documentação Oficial: <i>SQL Server Management Studio</i></b></a></div>

<br />

<h3>1.2. Criando o primeiro Banco de Dados</h3>

1. Uma vez que estamos no **SQL Server Management Studio** precisamos nos conectar com o **SQL Server**, através da tela abaixo:

<div align="center"><img src="https://i.imgur.com/27klobI.png" title="source: imgur.com" /></div>

2. Configure a sua conexão igual a imagem abaixo, alterando o item **Nome do servidor** para **localhost**:

<div align="center"><img src="https://i.imgur.com/ue0tGWa.png" title="source: imgur.com" /></div>

3.  Será aberta a janela principal do **SQL Server Management Studio**:

<div align="center"><img src="https://i.imgur.com/KjCzLoH.png" title="source: imgur.com" /></div>

4. Caso a janela de consultas (**SQLQuery1.sql**) não tenha sido aberta automaticamente, na Barra de Ferramentas do **SQL Server Management Studio**, clique no botão **Nova Consulta**:

<div align="center"><img src="https://i.imgur.com/gjdIRZ1.png" title="source: imgur.com" /></div>

5. Nesta janela (destacada com a cor verde), onde vamos criar as nossas instruções SQL.

<div align="center"><img src="https://i.imgur.com/IjIXRLb.png" title="source: imgur.com" /></div>

<br />

<h3>1.3. Executando consultas no SQL Server Management Studio</h3>



Para executar uma Query utilizaremos o comando Executar <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />, disponível na Barra de Ferramentas do **SQL Server Management Studio**:

<div align="center"><img src="https://i.imgur.com/3EXuyTV.png" title="source: imgur.com" /></div>

O Comando executar pode ser utilizado de duas formas diferentes:

1. Selecionando as linhas que você deseja executar;
2. Executando todas as linhas sequencialmente, caso você não selecione as linhas que você deseja executar.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="120px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao utilizar o comando Executar. O SQL não funciona da mesma forma que as Linguagens de Programação tradicionais. Cada instrução é única e o seu final é determinado pelo ponto e virgula (;). Na prática funciona como se fossem comandos do Terminal: Cada instrução faz uma ação e uma instrução nem sempre dependerá das instruções anteriores.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>1.4. Banco de Dados - Exemplo</h3>

Utilizaremos como Banco de dados guia do nosso aprendizado da Linguagem SQL, através do SQL Server, o Banco de dados **db_quitanda**. A Primeira tabela que vamos criar dentro do Banco **db_quitanda**, será a tabela **tb_produtos**, que possui a estrutura abaixo:

<div align="center"><img src="https://i.imgur.com/1IO9hPH.png" title="source: imgur.com" width="35%"/></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="120px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao utilizar a Linguagem SQL. Embora estejamos utilizando o Banco de dados SQL Server como ferramenta de aprendizado, a Linguagem SQL é universal para qualquer Banco de dados Relacional. É verdade que entre os SGBD's existem algumas sutis diferenças, mas na essência é a mesma Linguagem* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/>Criar o Banco de dados</h2>



Na **Janela de Consultas**, digite e execute a query abaixo utilizando o botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />:

<h4>CREATE DATABASE</h4>

```sql
CREATE DATABASE db_quitanda;
```
A instrução **CREATE DATABASE** é um comando do tipo **DDL (Data Definition Language)**, utilizado para criar um Banco de dados.

> **Relembrando...**
>
> - **DML - Linguagem de Manipulação de Dados:** instruções DML indicam uma ação para o SGBD executar. Utilizados para recuperar,  inserir e modificar um registro no banco de dados. Seus principais  comandos são: **INSERT, DELETE, UPDATE e  SELECT;**
> - **DDL - Linguagem de Definição de Dados:** instruções  DDL são responsáveis pela criação, alteração e exclusão dos objetos no  banco de dados, ou seja, pela estrutura do Banco e suas Tabelas. Seus  principais comandos são: **CREATE DATABASE, CREATE TABLE, ALTER TABLE e DROP TABLE;**

Ao executar a consulta, será exibida a janela **Mensagens**, que tem como principal objetivo indicar se a query foi executada com sucesso ou não. Se o Banco de dados foi criado com sucesso, será exibida uma mensagem informando que a operação foi efetuada com sucesso, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/7x91TBl.png" title="source: imgur.com" /></div>

Um Banco de dados, só pode ser criado uma única vez, logo se você executar a instrução acima novamente, você receberá uma mensagem de erro, na janela de **Mensagens**, informando que o **Banco de dados já existe**:

<div align="center"><img src="https://i.imgur.com/e8xOow6.png" title="source: imgur.com" /></div>

Para visualizar o **Banco de Dados db_quitanda**, Na janela **Pesquisador de Objetos**, localizada no lado esquerdo da tela, selecione o servidor <img src="https://i.imgur.com/Uz7gUN4.png" title="source: imgur.com" />**localhost** e clique no botão **Atualizar** <img src="https://i.imgur.com/w0H9RB6.png" title="source: imgur.com" />.

<div align="center"><img src="https://i.imgur.com/ij7yMYl.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *O comando atualizar só funciona se o Servidor do Banco de dados (localhost) estiver selecionado.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Na mesma janela, clique no sinal de (**+**) ao lado do item **Banco de Dados**:

<div align="center"><img src="https://i.imgur.com/IOQZ0I4.png" title="source: imgur.com" width="50%"/></div>

Veremos o **Banco de Dados db_quitanda**:

<div align="center"><img src="https://i.imgur.com/AhI9XZC.png" title="source: imgur.com" width="50%"/></div>

> **Porque o nome db_quitanda?**
>
> - db é a abreviação de Data Base. Este prefixo é utilizado para indicar que se trata de uma Banco de dados.
> - quitanda é nome do Banco de dados.

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_create_db.asp" target="_blank"><b>Documentação: <i>Create database - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/>Selecionando o Banco de Dados</h2>



Antes de criarmos nossa primeira tabela, é necessário indicar ao SQL Server em qual Banco de dados a tabela será criada. Para isso utilize a query abaixo, e em seguida selecione a query e execute através do comando <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com"/>.

<h4>USE</h4>

```sql
USE db_quitanda;
```

A instrução **USE** é um comando utilizado para selecionar um Banco de dados.

Ao executar a query, será exibida a seguinte mensagem:

<div align="center"><img src="https://i.imgur.com/7x91TBl.png" title="source: imgur.com" /></div>

Para confirmar se o Banco de dados está realmente selecionado, observe na **Barra de Ferramentas**, ao lado do botão **Executar**, se o nome do Banco de dados (**db_quitanda**), aparece conforme a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/TgQIdaq.png" title="source: imgur.com" /></div>

Uma vez o Banco selecionado, agora podemos executar todos os comandos.

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Evite erros no SQL. Selecione as instruções antes de clicar no botão executar.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://learn.microsoft.com/pt-br/sql/t-sql/language-elements/use-transact-sql?view=sql-server-ver16" target="_blank"><b>Documentação: <i>Use - SQL Server</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Criando nossa primeira Tabela</h2>



O processo para criação de uma tabela é bem simples, basta digitar a query abaixo, selecionar toda a query e em seguida executar através do botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com"/>.

<h4>CREATE TABLE</h4>

```sql
CREATE TABLE tb_produtos(
    Id BIGINT IDENTITY(1,1),
	Nome VARCHAR(255) NOT NULL,
	Quantidade INT,
    DataValidade DATE,
	Preco DECIMAL NOT NULL,
    PRIMARY KEY (id)
);
```

A instrução **CREATE TABLE** é um comando do tipo **DDL (Data Definition Language)**, utilizado para criar uma Tabela.

A clausula **IDENTITY** é um comando do tipo **DDL (Data Definition Language)** do SQL Server, utilizado para definir que um Atributo da Tabela será do tipo Auto Incremental, ou seja, a cada novo registro inserido na Tabela, este atributo receberá um número sequencial, **iniciando em 1 e incrementando de 1 em 1**. A clausula **IDENTITY** geralmente é utilizada no Atributo Chave Primária.

**Exemplo:**

- 1º registro = 1
- 2º registro = 2
- ...
- N registro = N

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Em outros Bancos de Dados Relacionais, ao invés de utilizar a clausula **IDENTITY(1,1)**, utilizamos outras clausulas para definir a opção Auto Incremental. Veja alguns exemplos na tabela abaixo:* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| SGBD         | Clausula       |
| ------------ | -------------- |
| MySQL        | AUTO INCREMENT |
| Postgres SQL | SERIAL         |
| Oracle       | AUTO_INCREMENT |

<br />

A clausula **NOT NULL** é um comando do tipo **DDL (Data Definition Language)**, utilizado para definir que um Atributo da Tabela não pode receber o valor nulo.

A clausula **PRIMARY KEY** é um comando do tipo **DDL (Data Definition Language)**, utilizado para definir qual Atributo será a Chave Primária da Tabela..

> **Relembrando...**
>
> A **chave primária** é o que torna a linha ou o registro de uma tabela únicos. Geralmente, é utilizada uma sequência numérica  automática para a geração dessa chave para que ela não venha a se repetir. Nenhuma linha possuirá o mesmo valor na coluna que é chave  primária, ou seja, será um identificador único do registro.

Caso a query tenha sido executada corretamente, será exibida a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/7x91TBl.png" title="source: imgur.com" /></div>

Para visualizar a **Tabela tb_produtos no Banco de Dados db_quitanda**, na janela **Pesquisador de Objetos**, localizada no lado esquerdo da tela, selecione o servidor <img src="https://i.imgur.com/Uz7gUN4.png" title="source: imgur.com" />**localhost** e clique no botão **Atualizar** <img src="https://i.imgur.com/w0H9RB6.png" title="source: imgur.com" />.

<div align="center"><img src="https://i.imgur.com/ij7yMYl.png" title="source: imgur.com" /></div>

Na mesma janela, clique no sinal de (**+**) ao lado do item **Banco de Dados**:

<div align="center"><img src="https://i.imgur.com/IOQZ0I4.png" title="source: imgur.com" width="50%"/></div>

Clique no sinal de (**+**) ao lado do **Banco de Dados db_quitanda**:

<div align="center"><img src="https://i.imgur.com/jaom7Fv.png" title="source: imgur.com" width="50%"/></div>

Clique no sinal de (**+**) ao lado do item **Tabelas**:

<div align="center"><img src="https://i.imgur.com/SMHGqEw.png" title="source: imgur.com" width="50%"/></div>

Veremos a tabela **tb_produtos** dentro do **Banco de Dados db_quitanda**:

<div align="center"><img src="https://i.imgur.com/aQTK7jT.png" title="source: imgur.com" width="50%"/></div>

> **Porque o nome dbo.tb_produtos?**
>
> - **dbo** é a abreviação de Data Base Object. Este prefixo é utilizado para indicar que se trata de um Objeto do  Banco de dados.
> - **tb** é a abreviação de Table. Este prefixo é utilizado para indicar que se trata de uma Tabela do Banco de dados.
> - **produtos** é nome da Entidade (Tabela).

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="120px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao criar as tabelas. Caso o comando USE, que seleciona Banco de dados atual, não seja executado antes do comando CREATE TABLE, o SQL Server retornará uma mensagem de erro indicando que o Banco de dados não foi selecionado ou criará a tabela em outro Banco de dados.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_create_table.asp" target="_blank"><b>Documentação: <i>Create Table - W3Schools</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_primarykey.asp" target="_blank"><b>Documentação: <i>Primary Key - W3Schools</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_autoincrement.asp" target="_blank"><b>Documentação: <i>SQL Auto Increment / Identity - W3Schools</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_notnull.asp" target="_blank"><b>Documentação: <i>Clausula Not Null - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Inserindo dados na Tabela</h2>



Uma vez que já temos a tabela criada, precisamos inserir dados (registros). Para inserir os dados, digite a sequência de instruções abaixo, seguindo a sintaxe/estrutura do código e em seguida selecione as linhas que contém os 6 produtos e execute a query utilizando o botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />.

<h4>INSERT INTO</h4>

```sql
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Tomate', 100, '2023-12-15', 8.00);
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Maçã', 20, '2023-12-15', 5.00);
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Laranja', 50, '2023-12-15', 10.00);
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Banana', 200, '2023-12-15', 12.00);
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Uva', 1200, '2023-12-15', 30.00);
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
VALUES ('Pêra', 500, '2023-12-15', 2.99);
```

A instrução **INSERT INTO** é um comando do tipo **DML (Data Manipulation Language)**, utilizado para inserir dados em uma Tabela. **VALUES** faz parte da instrução **INSERT INTO** e tem a função de indicar quais valores serão inseridos na tabela.

No SQL Server, os Atributos do tipo **VARCHAR** e **DATE**, **devem ser escritos entre aspas simples (' ')**. Em outros Bancos de Dados Relacionais, como o MySQL e o Postgres SQL, **utilizamos aspas duplas (" ")**.

Após executar a query, se os dados dos produtos forem inseridos corretamente na tabela, será exibida a seguinte mensagem abaixo, indicando que os 6 registros fora inseridos na tabela:

<div align="center"><img src="https://i.imgur.com/VahBbzr.png" title="source: imgur.com" /></div>

<br>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="180px"/> | **IMPORTANTE:** Como definimos que o Atributo `Id` será chave primária (`PRIMARY KEY`) e será atualizado automaticamente de um em um a cada registro inserido, através da instrução `IDENTITY(1,1)`, não é necessário inserir um valor para o Atributo Id. |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

Podemos escrever esta mesma instrução de uma forma mais simples, juntando todos os "VALUES" em uma única instrução:

```sql
INSERT INTO tb_produtos(Nome, Quantidade, DataValidade, Preco) 
values ('Tomate', 100, '2023-12-15', 8.00),
('Maçã', 20, '2023-12-15', 5.00),
('Laranja', 50, '2023-12-15', 10.00),
('Banana', 200, '2023-12-15', 12.00),
('Uva', 1200, '2023-12-15', 30.00),
('Pêra', 500, '2023-12-15', 2.99);
```

 <br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="120px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao inserir dados nas tabelas. Diferente do comando CREATE TABLE, o comando INSERT INTO pode ser repetido quantas vezes você desejar, entretanto esta não é uma prática recomendada porque gera duplicidade de dados na tabela.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_insert.asp" target="_blank"><b>Documentação: <i>Insert Into - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Selecionando dados da Tabela</h2>



Vamos fazer a nossa primeira consulta na Tabela **tb_produtos** e ver se os dados foram inseridos corretamente. Para consultar os dados, digite a instrução abaixo, em seguida selecione e execute a query utilizando o botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />:

<h4>SELECT</h4>

```sql
SELECT * FROM tb_produtos;
```

A instrução **SELECT** é um comando do tipo **DML (Data Manipulation Language)**, utilizado para selecionar dados em uma Tabela. 

A clausula **FROM** faz parte da instrução **SELECT** e tem a função de indicar em qual tabela os dados estão armazenados. O asterisco (*) indica que serão exibidas todas as colunas (atributos) da tabela.

O resultado da query será exibido logo abaixo:

<br>

<div align="center"><img src="https://i.imgur.com/OqIfujG.png" title="source: imgur.com" /></div>

<br>

Caso você deseje selecionar apenas um Atributo como por exemplo o **Nome**, basta substituir o **asterisco** ( * ) pelo nome do Atributo desejado. Para consultar os dados, digite a instrução abaixo, em seguida selecione e execute a query utilizando o botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />:

```sql
SELECT Nome FROM tb_produtos;
```

O resultado da query será exibido logo abaixo:

<div align="center"><img src="https://i.imgur.com/NK9vkQx.png" title="source: imgur.com" /></div>

Caso seja necessário mostrar dois ou mais Atributos, **utilize a vírgula** para separar os Atributos. Para consultar os dados, digite a instrução abaixo, em seguida selecione e execute a query utilizando o botão <img src="https://i.imgur.com/hY0lt5I.png" title="source: imgur.com" />:

```sql
SELECT Nome, Preco FROM tb_produtos;
```

O resultado da query será exibido logo abaixo:

<div align="center"><img src="https://i.imgur.com/cXuGFc2.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_select.asp" target="_blank"><b>Documentação: <i>Select - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Selecionando dados da Tabela com critérios de filtragem</h2>



Caso haja a necessidade de retornar apenas uma linha especifica, utilizarmos a cláusula `WHERE` seguido do Atributo que queremos filtrar. 

**Exemplo**: Desejamos retornar todas as informações do Produto cujo `Id` seja igual 1. Nesse caso executamos a seguinte query: 

<h4>WHERE</h4>

```sql
SELECT * FROM tb_produtos WHERE Id = 1;
```

A clausula **WHERE** faz parte da instrução **SELECT** e tem a função de indicar os critérios (filtros) para seleção dos dados. Neste exemplo foi utilizado o operador relacional de igualdade (=).

O resultado da query será exibido logo abaixo:

<div align="center"><img src="https://i.imgur.com/0TvtClq.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_where.asp" target="_blank"><b>Documentação: <i>Where - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/>Selecionando dados com os Operadores Relacionais</h2>



Caso haja a necessidade de retornar registros com base em comparações, basta utilizarmos o código `WHERE` junto com os **Operadores Relacionais**, informando o Atributo que será utilizado na comparação. 

| Operador | Descrição              |
| -------- | ---------------------- |
| **>**    | Maior do que           |
| **>=**   | Maior do que ou  igual |
| **<**    | Menor do que           |
| **<=**   | Menor do que ou igual  |
| **=**    | igual                  |
| **<>**   | diferente              |

**Exemplo**: Desejamos retornar todos os produtos que tenham preço acima de R$ 5,00. Nesse caso executamos a seguinte query:

<h4>WHERE com Operados Relacionais</h4>

```sql
SELECT * FROM tb_produtos WHERE Preco > 5.00;
```

O resultado da query será exibido logo abaixo:

<div align="center"><img src="https://i.imgur.com/xd6mMy1.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_operators.asp" target="_blank"><b>Documentação: <i>Operadores - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/>Selecionando dados com os Operadores Lógicos</h2>



Caso haja a necessidade de retornar um registro com base em um teste lógico (VERDADEIRO ou FALSO), basta utilizarmos o código `WHERE` junto com os **Operadores Lógicos**, informando o Atributo que será utilizado na comparação. 

| Operador | Descrição                                              |
| -------- | ------------------------------------------------------ |
| **AND**  | Verdadeiro somente se as 2 condições forem verdadeiras |
| **OR**   | Verdadeiro se pelo menos 1 condição for verdadeira     |
| **NOT**  | Negação (inverso)                                      |

**Exemplo**: Desejamos retornar todos os produtos cujo preço esteja acima de R$ 5,00 **E** a quantidade de itens no estoque seja inferior a 100. Nesse caso executamos a seguinte query:

<h4>WHERE com Operadores Lógicos</h4>

```sql
SELECT * FROM tb_produtos WHERE Preco > 5.00 AND Quantidade < 100;
```

O resultado da query será exibido logo abaixo:

<div align="center"><img src="https://i.imgur.com/JGhFZ83.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_operators.asp" target="_blank"><b>Documentação: <i>Operadores - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/> Modificando a Estrutura da Tabela - Modificando a estrutura de uma Coluna</h2>



O comando **ALTER** é um comando do tipo **DDL (Data Definition Language)**, utilizado para adicionar, excluir ou modificar as colunas (Atributos), em uma tabela existente, além de poder adicionar ou excluir restrições em uma tabela, como chave primária e/ou chaves estrangeiras. 

Observem o Produto Pêra:

```sql
SELECT * FROM tb_produtos WHERE Id = 6;
```

<br />

<div align="center"><img src="https://i.imgur.com/yVHFsuI.png" title="source: imgur.com" /></div>

Quando ele foi cadastrado, nós passamos o valor **R$ 2.99**, entretanto, o valor foi arredondado para **3** e as casas decimais não estão sendo exibidas. Por que?

A resposta é simples: Ao definirmos a estrutura da tabela, nós não indicamos para o tipo DECIMAL o numero de casas decimais:

<div align="center"><img src="https://i.imgur.com/MaOX9Bi.png" title="source: imgur.com" /></div>

Através do comando **ALTER**, nós vamos modificar a estrutura do Atributo **Preco** tenha 6 dígitos, sendo que 2 deles serão as casas decimais (1000.50). Nesse caso utilizaremos a seguinte query: 

<h4>ALTER TABLE - ALTER COLUMN</h4>

```sql
ALTER TABLE tb_produtos ALTER COLUMN Preco DECIMAL(6,2);
```

A clausula **ALTER COLUMN** faz parte do comando **ALTER** e tem a função de alterar a estrutura de um Atributo da Tabela.

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Em outros Bancos de Dados Relacionais, ao invés de utilizar a clausula **ALTER COLUMN**, utilizamos outras clausulas para alterar a estrutura de um Atributo (coluna). Veja alguns exemplos na tabela abaixo:* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| SGBD         | Clausula     |
| ------------ | ------------ |
| MySQL        | MODIFY       |
| Postgres SQL | ALTER COLUMN |
| Oracle       | MODIFY       |

<br />

Observe que após esta alteração o Atributo Preco será exibido com as casas decimais:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/yoyqtrr.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/L338M2G.png" title="source: imgur.com" width="120px"/> | **DESAFIO 01:** *Observe que mesmo corrigindo as casas decimais, o preço da Pêra continua arredondado para R$ 3.00. Como podemos corrigir o preço deste produto para R$ 2.99?* |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_alter.asp" target="_blank"><b>Documentação: <i>Alter Table - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/> Modificando a Estrutura da Tabela - Adicionando uma nova Coluna</h2>



Vamos continuar utilizando o comando **ALTER** para fazer mais algumas mudanças na estrutura da nossa tabela.

Imagine que esquecemos de adicionar o Atributo **Descrição** na nossa Tabela. Para inserir o novo Atributo executaremos a seguinte query: 

<h4>ALTER TABLE - ADD</h4>

```sql
ALTER TABLE tb_produtos ADD Descricao VARCHAR(255);
```

A clausula **ADD** faz parte do comando **ALTER** e tem a função de adicionar um novo Atributo na tabela.

Observe que após esta alteração o Atributo **Descricao** será exibido na tabela, com valores nulos:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/rSOPDSh.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/L338M2G.png" title="source: imgur.com" width="80px"/> | **DESAFIO 02:** *Como podemos adicionar uma descrição diferente para cada produto?* |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_alter.asp" target="_blank"><b>Documentação: <i>Alter Table - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Atualizando dados na Tabela</h2>



Para atualizar os dados da tabela devemos utilizar o comando `Update` no registro que queremos atualizar. Para resolver os **Desafios 01 e 02**, utilizaremos o comando update. 

Um ponto importante a ser destacado em relação ao comando update é que podemos utilizá-lo de duas formas:

1. Alterar todos os registros com a mesma alteração, **prática esta que não é recomendada**. **Exemplo:** Alterar a data de validade de todos os produtos para 11/01/2024.
2. Alterar um ou um conjunto de registros específicos, definidos através da clausula **WHERE**, **prática esta que é a mais recomendada**. **Exemplo:** Alterar a data de validade do produto, cujo Id é igual a 1, para 11/01/2024.

<br />


| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="300px"/> | **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao construir a query update. Obrigatoriamente você DEVE COLOCAR o comando WHERE, pois caso contrário o SQL Server Management Studio irá atualizar TODOS OS REGISTROS, sem a possibilidade de desfazer a atualização incorreta.* |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<h4>UPDATE</h4>

**Solução - Desafio 01**

```sql
UPDATE tb_produtos SET Preco = 2.99 WHERE Id = 6;
```

A instrução **UPDATE** é um comando do tipo **DML (Data Manipulation Language)**, utilizado para alterar os dados em  um registro (linha) ou em um conjunto de registros (linhas), em uma Tabela, que atendam a um ou mais critérios. 

A clausula **SET** faz parte da instrução **UPDATE** e tem a função de indicar quais atributos serão alterados.

A clausula **WHERE** também faz parte da instrução **UPDATE** e tem a função de indicar os critérios (filtros) para seleção dos dados, que serão atualizados.

Observe que após executar a query acima, no Atributo Preco do produto cujo Id é igual a 6 (Pêra), o Preço foi alterado de R$ 3.00, para R$ 2.99:

```sql
SELECT * FROM tb_produtos WHERE Id = 6;
```

<div align="center"><img src="https://i.imgur.com/wjtwen1.png" title="source: imgur.com" /></div>

<br />

**Solução - Desafio 02:**

Para resolver o Desafio 02, teríamos que criar uma query UPDATE para cada Produto:

```sql
UPDATE tb_produtos SET Descricao = 'Tomate Italiano' WHERE Id = 1;
UPDATE tb_produtos SET Descricao = 'Maçã Verde' WHERE Id = 2;
UPDATE tb_produtos SET Descricao = 'Laranja Lima' WHERE Id = 3;
UPDATE tb_produtos SET Descricao = 'Banana Prata' WHERE Id = 4;
UPDATE tb_produtos SET Descricao = 'Uva Italiana' WHERE Id = 5;
UPDATE tb_produtos SET Descricao = 'Pêra Williams' WHERE Id = 6;
```

Observe que após executar as 6 queries acima, cada produto recebeu a sua própria descrição:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/PvXV505.png" title="source: imgur.com" /></div>

<br />

**Update sem WHERE**

Todas as vezes que utilizarmos o comando **UPDATE** não podemos esquecer de utilizar a clausula **WHERE**, indicando quais registros serão alterados. Caso contrário, faremos um alteração que será aplicada em todos os registros do nossa tabela e esta alteração não poderá ser desfeita.

<br />

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATENÇÃO:** *Este comando é apenas um exemplo. Lembre-se que caso você o execute, a alteração não poderá ser desfeita e todos os produtos passarão a ter o mesmo preço*. A única forma de corrigir o preço, seria criar uma query para cada produto, assim como fizemos no Desafio 02.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

```sql
UPDATE tb_produtos SET Preco = 5.00;
```

Observe que caso esta alteração no Atributo Preco seja efetuada, o preço de todos os produtos foram alterados para R$ 5.00:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/kynhBcS.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_update.asp" target="_blank"><b>Documentação: <i>Update - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="30px"/> Apagando dados na Tabela</h2>



Para apagar um ou mais registros da tabela, utilizamos o comando `DELETE`.

Um ponto importante a ser destacado em relação ao comando delete é que podemos utilizá-lo de duas formas:

1. Apagar todos os registros de uma única vez, **prática esta que não é recomendada**. 
2. Apagar um ou um conjunto de registros específicos, definidos através da clausula **WHERE**, **prática esta que é a mais recomendada**. **Exemplo:** Excluir o produto, cujo Id é igual a 2.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="300px"/> | **ALERTA DE BSM:** *Mantenha a Atenção aos Detalhes ao construir a query delete, pois obrigatoriamente você DEVE COLOCAR o comando WHERE, pois caso contrário o SQL Server  irá APAGAR TODOS OS REGISTROS, sem a possibilidade de desfazer a operação.* |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<h4>DELETE</h4>

```sql
DELETE FROM tb_produtos WHERE Id = 2;
```

A instrução **DELETE** é um comando do tipo **DML (Data Manipulation Language)**, utilizado para excluir um registro (linha) ou em um conjunto de registros (linhas), em uma Tabela, que atendam a um ou mais critérios. 

A clausula **WHERE** também faz parte da instrução **DELETE** e tem a função de indicar os critérios (filtros) para seleção dos dados, que serão apagados.

Observe que após executar a query acima, o produto cujo Id é igual a 2 (Maçã), foi excluído e a consulta abaixo não retornará nada:

```sql
SELECT * FROM tb_produtos WHERE Id = 2;
```

<div align="center"><img src="https://i.imgur.com/V1bdLql.png" title="source: imgur.com" /></div>

Observe que ao executar a query abaixo (listar todos os produtos), o produto cujo Id é igual a 2 não existe mais:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/5lEoVBj.png" title="source: imgur.com" /></div>

<br>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="180px"/> | **IMPORTANTE:** Uma vez que um registro (linha) foi excluído, o Id não poderá mais ser reutilizado. Lembre-se que o Id é a Chave Primária, o identificador único da tabela, que funciona como o RG: O número do RG não pode ser transferido para outra pessoa, da mesma forma é a Chave Primária. |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

**Delete sem WHERE**

Todas as vezes que utilizarmos o comando **DELETE** não podemos esquecer de utilizar a clausula **WHERE**, indicando quais registros serão deletados. Caso contrário, todos os registros da nossa tabela serão apagados e esta alteração não poderá ser desfeita.

<br />

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATENÇÃO:** *Este comando é apenas um exemplo. Lembre-se que caso você o execute, a alteração não poderá ser desfeita e todos os produtos serão excluídos*. As únicas formas de recuperar seria cadastrar tudo novamente, entretanto os Ids seriam diferentes.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

```sql
DELETE FROM tb_produtos;
```

Observe que caso esta exclusão seja efetuada, todos os produtos serão excluídos e a consulta abaixo não retornará nada:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/V1bdLql.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_delete.asp" target="_blank"><b>Documentação: <i>Delete - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/> Modificando a Estrutura da Tabela - Excluindo uma Coluna</h2>



Vamos finalizar o comando **ALTER** para fazer mais uma alteração na estrutura da nossa tabela.

Imagine que o Atributo **Descrição** da nossa Tabela deixou de ser necessário e por isso vamos excluí-lo. Para remover o Atributo executaremos a seguinte query: 

<h4>ALTER TABLE - DROP</h4>

```sql
ALTER TABLE tb_produtos DROP COLUMN Descricao;
```

A clausula **DROP COLUMN** faz parte do comando **ALTER** e tem a função de remover um Atributo da tabela.

<br />

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Em outros Bancos de Dados Relacionais, ao invés de utilizar a clausula **DROP COLUMN**, utilizamos outras clausulas para remover um Atributo (coluna). Veja alguns exemplos na tabela abaixo:* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| SGBD         | Clausula    |
| ------------ | ----------- |
| MySQL        | DROP        |
| Postgres SQL | DROP COLUMN |
| Oracle       | DROP        |

<br />

Observe que após esta alteração, o Atributo **Descricao** não será mais exibido na tabela e todos os seus dados também serão excluídos:

```sql
SELECT * FROM tb_produtos;
```

<div align="center"><img src="https://i.imgur.com/TZdSgbE.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_alter.asp" target="_blank"><b>Documentação: <i>Alter Table - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/> Modificando a Estrutura da Tabela - Definir a Chave Primária</h2>



Caso você tenha esquecido de criar a Chave Primária em uma tabela, utilize o comando abaixo:

```sql
ALTER TABLE tb_produtos ADD PRIMARY KEY (Id); 
```

A clausula **ADD PRIMARY KEY** faz parte do comando **ALTER** e tem a função de definir qual Atributo da tabela será a Chave Primária, caso você não tenha especificado na criação da tabela. Para definir a Chave Primária é necessário que o Atributo tenha sido criado na tabela. Caso ele não tenha sido criado, utilize o comando **ALTER TABLE** com a Cláusula **ADD**.

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_primarykey.ASP" target="_blank"><b>Documentação: <i>Alter Table - Primary Key - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/> Modificando a Estrutura da Tabela - Apagando uma Tabela</h2>



Caso você precise apagar uma tabela, utilize o comando abaixo:

<br />

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATENÇÃO:** *Este comando é apenas um exemplo. Lembre-se que caso você o execute, a sua tabela será excluída e o comando não poderá ser desfeito.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

```sql
DROP TABLE tb_produtos; 
```

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_drop_table.asp" target="_blank"><b>Documentação: <i>Drop Table - W3Schools</i></b></a></div>

<br />

<h2><img src="https://i.imgur.com/ZL3AFqF.png" title="source: imgur.com" width="5%"/>Apagando um Banco de dados</h2>



Caso você precise apagar um Banco de dados e todas as suas tabelas, utilize o comando abaixo:

<br />

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATENÇÃO:** *Este comando é apenas um exemplo. Lembre-se que caso você o execute, o seu Banco de dados será excluído e o comando não poderá ser desfeito.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

```sql
DROP DATABASE db_quitanda; 
```

<br />

<div align="left"><img src="https://i.imgur.com/38hZn7Z.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/sql/sql_drop_db.asp" target="_blank"><b>Documentação: <i>Drop Database - W3Schools</i></b></a></div>

<br />

<h2>2. Salvando o Script SQL</h2>



Para Salvar o Script SQL, siga as instruções abaixo:

1. Na Barra de Ferramentas do SQL Server Management Studio, clique no botão <img src="https://i.imgur.com/Zka1MbL.png" title="source: imgur.com" /> (Salvar).

   <div align="center"><img src="https://i.imgur.com/PvzL9n2.png" title="source: imgur.com" /></div>

2. Será aberta a janela **Salvar Arquivo como**

3. Localize a pasta que você deseja Salvar o seu arquivo. No campo **Nome** informe o nome do arquivo e clique no botão **Salvar** para concluir o processo.

   <div align="center"><img src="https://i.imgur.com/KExNVjh.png" title="source: imgur.com" /></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
